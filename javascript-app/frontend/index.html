<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Voice Analyzer</title>
  <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 64 64'%3E%3Cdefs%3E%3ClinearGradient id='g' x1='0' y1='0' x2='1' y2='1'%3E%3Cstop stop-color='%232193b0'/%3E%3Cstop stop-color='%236dd5ed' offset='1'/%3E%3C/linearGradient%3E%3C/defs%3E%3Crect width='64' height='64' rx='12' fill='%230e1116'/%3E%3Cpath d='M10 42 L18 22 L24 42 L30 18 L36 46 L42 22 L48 42 L54 26' stroke='url(%23g)' stroke-width='6' fill='none' stroke-linecap='round' stroke-linejoin='round'/%3E%3C/svg%3E">
  <link rel="stylesheet" href="./style.css">
  <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
</head>
<body>
  <main class="page">
    <header class="hero">
      <div>
        <h1>Voice Analyzer</h1>
        <p class="lede">Capture audio (mic or synthetic), buffer it, and plot time-domain, spectrum, and surface views with low latency.</p>
      </div>
      <div class="cta center-cta">
        <button id="enableAudio" class="primary">Enable Mic Input ðŸ¥º</button>
      </div>
    </header>

    <section class="card layout">
      <div class="stack">
        <h2>Input</h2>
        <div class="input-grid">
          <label class="control">
            <span>Source</span>
            <select id="inputSource">
              <option value="mic">Microphone</option>
              <option value="synthetic">Synthetic</option>
            </select>
          </label>
          <label class="control">
            <span>Gain (dB)</span>
            <input id="gain" type="number" step="1" min="-60" max="12" value="0">
          </label>
          <label class="control">
            <span>Sample rate (Hz)</span>
            <input id="sampleRateInput" type="number" min="8000" step="1000">
          </label>
          <label class="control">
            <span>Channels</span>
            <input id="channelsInput" type="number" min="1" max="2" step="1">
          </label>
          <label class="control">
            <span>Frames per chunk</span>
            <input id="framesPerChunk" type="number" min="128" step="128">
          </label>
          <label class="control">
            <span>Sample width (bytes)</span>
            <input id="sampleWidthBytes" type="number" min="1" max="4" step="1">
          </label>
          <label class="control span-2" id="syntheticFrequencyControl">
            <span>Synthetic frequencies (Hz, comma separated)</span>
            <input id="syntheticFrequencies" type="text" value="220,440,880" aria-label="Synthetic frequencies">
          </label>
        </div>
      </div>
    </section>

    <section class="card figure-layout">
      <div class="stack figure-controls">
        <label class="control">
          <span>Time window (ms)</span>
          <input id="timeWindow" type="number" min="10" step="10">
        </label>
        <label class="control">
          <span>Max points</span>
          <input id="maxPoints" type="number" min="32" step="10">
        </label>
        <label class="control">
          <span>Refresh interval (ms)</span>
          <input id="refreshInterval" type="number" min="5" step="5">
        </label>
        <label class="control">
          <span>Max amplitude</span>
          <input id="maxAmplitudeInput" type="number" min="0.1" step="0.1">
        </label>
        <label class="control">
          <span>Line width (px)</span>
          <input id="lineWidth" type="number" min="0.5" step="0.5">
        </label>
        <label class="control">
          <span>Marker size (px)</span>
          <input id="markerSize" type="number" min="0" step="0.5">
        </label>
      </div>

      <div class="figure">
        <div class="figure-header">
          <div>
            <h3>Live audio signal</h3>
          </div>
          <div class="small">
            <span id="figureMeta"></span>
          </div>
        </div>
        <canvas id="signalCanvas" width="2160" height="640"></canvas>
      </div>
    </section>

    <section class="card figure-layout">
      <div class="stack figure-controls">
        <div class="param-grid">
          <label class="control">
            <span>Time window (ms)</span>
            <input id="fftTimeWindow" type="number" min="10" step="10">
          </label>
          <label class="control">
            <span>FFT size</span>
            <input id="fftSize" type="number" min="256" step="256">
          </label>
          <label class="control">
            <span>Window function</span>
            <select id="windowFunc">
              <option value="rect">Rect</option>
              <option value="hann">Hann</option>
              <option value="hamming">Hamming</option>
              <option value="blackman">Blackman</option>
            </select>
          </label>
          <label class="control">
            <span>Scale</span>
            <select id="fftScale">
              <option value="linear">Linear</option>
              <option value="log">Log</option>
            </select>
          </label>
          <label class="control">
            <span>Min frequency (Hz)</span>
            <input id="minFrequency" type="number" min="0" step="10">
          </label>
          <label class="control">
            <span>Max frequency (Hz)</span>
            <input id="maxFrequency" type="number" min="10" step="10">
          </label>
          <label class="control">
            <span>Smoothing (0â€“0.99)</span>
            <input id="smoothing" type="number" min="0" max="0.99" step="0.05">
          </label>
          <label class="control">
            <span>Refresh interval (ms)</span>
            <input id="fftRefreshInterval" type="number" min="5" step="5">
          </label>
          <label class="control">
            <span>Line width (px)</span>
            <input id="fftLineWidth" type="number" min="0.5" step="0.5">
          </label>
          <label class="control">
            <span>Marker size (px)</span>
            <input id="fftMarkerSize" type="number" min="0" step="0.5">
          </label>
        </div>
      </div>

      <div class="figure">
        <div class="figure-header">
          <div>
            <h3>Live FFT spectrum</h3>
          </div>
          <div class="small">
            <span id="fftMeta"></span>
          </div>
        </div>
        <canvas id="fftCanvas" width="2160" height="640"></canvas>
      </div>
    </section>

    <section class="card figure-layout">
      <div class="stack figure-controls">
        <div class="param-grid">
          <label class="control">
            <span>Displayed time window (ms)</span>
            <input id="surfaceWindow" type="number" min="100" step="100">
          </label>
          <label class="control">
            <span>FFT time segment (ms)</span>
            <input id="surfaceSegment" type="number" min="10" step="10">
          </label>
          <label class="control">
            <span>FFT size</span>
            <input id="surfaceFftSize" type="number" min="256" step="256">
          </label>
          <label class="control">
            <span>Time bins</span>
            <input id="surfaceTimeBins" type="number" min="20" step="10">
          </label>
          <label class="control">
            <span>Frequency bins</span>
            <input id="surfaceFrequencyBins" type="number" min="20" step="10">
          </label>
          <label class="control">
            <span>Min frequency (Hz)</span>
            <input id="surfaceMinFrequency" type="number" min="0" step="10">
          </label>
          <label class="control">
            <span>Max frequency (Hz)</span>
            <input id="surfaceMaxFrequency" type="number" min="10" step="10">
          </label>
          <label class="control">
            <span>Colormap</span>
            <select id="surfaceColormap">
              <option value="inferno">Inferno</option>
              <option value="viridis">Viridis</option>
              <option value="plasma">Plasma</option>
              <option value="magma">Magma</option>
              <option value="turbo">Turbo</option>
              <option value="ice">Ice</option>
              <option value="mono">Mono</option>
            </select>
          </label>
          <label class="control">
            <span>Refresh interval (ms)</span>
            <input id="surfaceRefreshInterval" type="number" min="5" step="5">
          </label>
          <label class="control">
            <span>Interpolation</span>
            <select id="surfaceInterpolation">
              <option value="linear">Linear</option>
              <option value="nearest">Nearest</option>
              <option value="quadratic">Quadratic</option>
              <option value="spline">Spline</option>
            </select>
          </label>
        </div>
      </div>

      <div class="figure">
        <div class="figure-header">
          <div>
            <h3>Live surface plot</h3>
          </div>
          <div class="small">
            <span id="surfaceMeta"></span>
          </div>
        </div>
        <canvas id="surfaceCanvas" width="2160" height="720"></canvas>
      </div>
    </section>
  </main>

  <div id="streamIndicator" class="stream-indicator hidden">Streaming</div>

  <script type="module" src="./main.js"></script>
</body>
</html>
